{"version":3,"file":"BottomSheet.stories.faba42fa.js","sources":["../../src/assets/img/heroicons/mini/x-mark.tsx","../../src/components/BottomSheet/BottomSheet.tsx"],"sourcesContent":["interface Props {\n  className?: string;\n}\n\nconst XMark = (props: Props) => (\n  <svg\n    xmlns='http://www.w3.org/2000/svg'\n    viewBox='0 0 20 20'\n    fill='currentColor'\n    className={`w-5 h-5 ${props.className}`}\n  >\n    <path d='M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z' />\n  </svg>\n);\n\nexport default XMark;\n","import React, { ReactNode, useCallback, useEffect, useRef, useState, UIEvent } from 'react';\n\nimport ArrowLeft from '~/assets/img/heroicons/mini/arrow-left';\nimport XMark from '~/assets/img/heroicons/mini/x-mark';\n\nexport interface BottomSheetProps {\n  children?: ReactNode;\n  className?: string;\n  show: boolean;\n  title?: string;\n  description?: string;\n  backdrop?: boolean;\n  handle?: boolean;\n  keyboard?: boolean;\n  prefix?: boolean;\n  suffix?: boolean;\n  footer?: ReactNode;\n  onClose?: () => void;\n  onPrefix?: () => void;\n}\n\nconst HCBottomSheet: React.FC<BottomSheetProps> = (props: BottomSheetProps) => {\n  const ref = useRef<HTMLDivElement>(null);\n  const contentRef = useRef<HTMLDivElement>(null);\n  const footerRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    let observerRefValue: HTMLDivElement | null = null;\n\n    const handler = (e: Event) => {\n      // e.preventDefault();\n      e.stopPropagation();\n    };\n\n    if (ref.current) {\n      observerRefValue = ref.current;\n      observerRefValue.addEventListener('scroll', handler);\n      observerRefValue.addEventListener('wheel', handler);\n    }\n\n    return () => {\n      if (observerRefValue) {\n        observerRefValue.removeEventListener('scroll', handler);\n        observerRefValue.removeEventListener('wheel', handler);\n      }\n    };\n  }, []);\n\n  /**\n   * Position\n   *\n   * top, bottom & height\n   */\n  const [heightClass, setHeightClass] = useState('h-0');\n  const [dragging, setDragging] = useState(false);\n  const [draggingPosY, setDraggingPosY] = useState(0);\n  const [full, setFull] = useState(false);\n  const [topStyle, setTopStyle] = useState('100%');\n  const [bottomClass, setBottomClass] = useState('');\n  const [shadowClass, setShadowClass] = useState('');\n  const [backdropClass, setBackdropClass] = useState('invisible');\n  const [backdropOpacityClass, setBackdropOpacityClass] = useState('opacity-0');\n  const [footerTopStyle, setFooterTopStyle] = useState('100%');\n\n  const handleTouchDownHeader = useCallback((event: React.TouchEvent | React.MouseEvent) => {\n    setDragging(true);\n    setDraggingPosY((event as React.TouchEvent).changedTouches[0].pageY);\n  }, []);\n\n  const handleMouseDownHeader = useCallback((event: React.MouseEvent) => {\n    setDragging(true);\n    setDraggingPosY(event.pageY);\n  }, []);\n\n  useEffect(() => {\n    const handlePosition = (position: number) => {\n      setDragging(false);\n      if (position < draggingPosY) {\n        setFull(true);\n      } else {\n        if (full) {\n          setFull(false);\n        }\n      }\n    };\n\n    const handleTouchEnd = (event: TouchEvent) => {\n      handlePosition(event.changedTouches[0].pageY);\n    };\n\n    const handleMouseUp = (event: MouseEvent) => {\n      handlePosition(event.pageY);\n    };\n\n    if (props.handle && dragging) {\n      document.addEventListener('touchend', handleTouchEnd);\n      document.addEventListener('mouseup', handleMouseUp);\n    }\n\n    return () => {\n      document.removeEventListener('touchend', handleTouchEnd);\n      document.removeEventListener('mouseup', handleMouseUp);\n    };\n  }, [props.handle, dragging, draggingPosY, full]);\n\n  // Handle top class in the different case\n  useEffect(() => {\n    let timer: ReturnType<typeof setTimeout>;\n\n    if (props.show) {\n      setHeightClass('h-full');\n      setBackdropOpacityClass('opacity-100');\n      setBottomClass('bottom-0');\n\n      // TailwindCSS doesn't support dynamic class, so we handle this top case by style.\n      setFooterTopStyle(`calc(100% - ${footerRef.current?.clientHeight}px)`);\n      if (full) {\n        setTopStyle('24px');\n      } else if (props.keyboard || props.handle) {\n        setTopStyle('200px');\n      } else {\n        setTopStyle(`calc(100% - ${contentRef.current?.clientHeight}px)`);\n      }\n      timer = setTimeout(() => {\n        setShadowClass('drop-shadow-reversed');\n        setBackdropClass('visible');\n      }, 0);\n    } else {\n      setTopStyle('100%');\n      setHeightClass('h-0');\n      setBackdropOpacityClass('opacity-0');\n      setFooterTopStyle('100%');\n      timer = setTimeout(() => {\n        setBottomClass('');\n        setShadowClass('');\n        setBackdropClass('invisible');\n      }, 800);\n    }\n\n    return () => {\n      if (timer) {\n        clearTimeout(timer);\n      }\n    };\n  }, [props.show, props.handle, props.keyboard, full]);\n\n  return (\n    <div\n      ref={ref}\n      className={`${props.className} ${heightClass}\n      w-full absolute left-0 top-0`}\n    >\n      {/* Backdrop */}\n      {/* {props.backdrop && ( */}\n      <div\n        className={`\n            ${backdropClass} ${backdropOpacityClass}\n            w-screen h-screen bg-backdrop fixed left-0 top-0 transition-opacity duration-800 z-20`}\n      />\n      {/* )} */}\n\n      {/* Main */}\n      <div\n        ref={contentRef}\n        className={`\n          ${shadowClass} ${bottomClass}\n          w-full box-border rounded-t-3xl\n          first-letter:w-full bg-primary\n          fixed left-0 transition-all duration-500\n          flex flex-col z-30`}\n        style={{\n          top: topStyle,\n        }}\n      >\n        {/* Header */}\n        {props.title && (\n          <div\n            onTouchStart={handleTouchDownHeader}\n            onMouseDown={handleMouseDownHeader}\n            aria-hidden='true'\n          >\n            {props.handle && (\n              <div className='flex justify-center py-2'>\n                <div className='w-10 h-1 rounded bg-pressed'></div>\n              </div>\n            )}\n            <div\n              className={`\n                ${!props.handle && 'pt-3'} pb-3\n                flex justify-between border-b border-secondary`}\n            >\n              <div\n                className={`py-3.5 px-4 ${props.onPrefix ? 'cursor-pointer' : ''}`}\n                onClick={props.onPrefix}\n                aria-hidden='true'\n              >\n                <div className='w-5'>{props.prefix && <ArrowLeft />}</div>\n              </div>\n              <div\n                className={`flex justify-center items-center flex-col\n                ${!props.description && 'py-2.5'}`}\n              >\n                <span className='text-body-bold-l'>{props.title}</span>\n                <span className='text-body-s text-tertiary'>{props.description}</span>\n              </div>\n              <div\n                className={`py-3.5 px-4 ${props.onClose ? 'cursor-pointer' : ''}`}\n                onClick={props.onClose}\n                aria-hidden='true'\n              >\n                <div className='w-5'>{props.suffix && <XMark />}</div>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Content */}\n        <div\n          className='grow overflow-y-scroll'\n          style={{\n            paddingBottom: props.footer ? `${footerRef.current?.clientHeight}px` : 0,\n          }}\n        >\n          {props.children}\n        </div>\n\n        {/* Footer */}\n        {props.footer && (\n          <div\n            ref={footerRef}\n            className='w-full fixed transition-all duration-500 border-t border-secondary bg-primary z-10 p-4'\n            style={{\n              top: footerTopStyle,\n            }}\n          >\n            {props.footer}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nHCBottomSheet.defaultProps = {\n  show: false,\n  className: '',\n  title: '',\n  description: '',\n  backdrop: true,\n  handle: false,\n  keyboard: false,\n  prefix: false,\n  suffix: true,\n};\n\nexport default HCBottomSheet;\n"],"names":["XMark","props","_jsx","className","HCBottomSheet","ref","useRef","contentRef","footerRef","useEffect","observerRefValue","handler","e","heightClass","setHeightClass","useState","dragging","setDragging","draggingPosY","setDraggingPosY","full","setFull","topStyle","setTopStyle","bottomClass","setBottomClass","shadowClass","setShadowClass","backdropClass","setBackdropClass","backdropOpacityClass","setBackdropOpacityClass","footerTopStyle","setFooterTopStyle","handleTouchDownHeader","useCallback","event","handleMouseDownHeader","handlePosition","position","handleTouchEnd","handleMouseUp","document","timer","clearTimeout","_jsxs","onPrefix","ArrowLeft","title","description","onClose","_a","children","footer","HCBottomSheet$1"],"mappings":"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"}