{"version":3,"file":"BottomSheet.stories.baaa17b4.js","sources":["../../src/components/BottomSheet/BottomSheet.tsx"],"sourcesContent":["import React, { ReactNode, useCallback, useEffect, useRef, useState } from 'react';\n\nexport interface Props {\n  children?: ReactNode;\n  className?: string;\n  show: boolean;\n  header?: string;\n  description?: string;\n  backdrop?: boolean;\n  handle?: boolean;\n  keyboard?: boolean;\n  prefix?: ReactNode;\n  suffix?: ReactNode;\n  onClose?: () => void;\n  onPrefix?: () => void;\n  onSuffix?: () => void;\n}\n\nconst HCBottomSheet: React.FC<Props> = (props: Props) => {\n  const ref = useRef<HTMLDivElement>(null);\n\n  /**\n   * Position\n   *\n   * top, bottom & height\n   */\n  const [height, setHeight] = useState(0);\n  const [dragging, setDragging] = useState(false);\n  const [draggingPosY, setDraggingPosY] = useState(0);\n  const [full, setFull] = useState(false);\n  const [topClass, setTopClass] = useState('top-full');\n  const [bottomClass, setBottomClass] = useState('');\n\n  const onMouseDown = (event: React.MouseEvent) => {\n    setDragging(true);\n    setDraggingPosY(event.pageY);\n  };\n\n  const onMouseUp = useCallback(\n    (event: MouseEvent) => {\n      setDragging(false);\n      if (event.pageY < draggingPosY) {\n        // Up\n        setFull(true);\n      } else {\n        // Down\n        if (full) {\n          setFull(false);\n        }\n      }\n    },\n    [draggingPosY, full, props.onClose],\n  );\n\n  useEffect(() => {\n    if (ref.current) {\n      setHeight(ref.current?.clientHeight);\n    }\n  }, [ref.current?.children]);\n\n  useEffect(() => {\n    if (props.handle && dragging) {\n      document.addEventListener('mouseup', onMouseUp);\n    }\n\n    return () => {\n      document.removeEventListener('mouseup', onMouseUp);\n    };\n  }, [props.handle, dragging, onMouseUp]);\n\n  // Handle top class in the different case\n  useEffect(() => {\n    let timer: ReturnType<typeof setTimeout>;\n\n    if (!props.show) {\n      setTopClass('top-full');\n      timer = setTimeout(() => {\n        setBottomClass('');\n      }, 800);\n    } else if (full) {\n      setTopClass('top-6');\n      setBottomClass('bottom-0');\n    } else if (props.keyboard || props.handle) {\n      setTopClass('top-50');\n      setBottomClass('bottom-0');\n    } else {\n      // TailwindCSS doesn't support dynamic class, so we handle this case by style.\n      setTopClass(``);\n    }\n\n    return () => {\n      if (timer) {\n        clearTimeout(timer);\n      }\n    };\n  }, [props.show, props.handle, props.keyboard, full, height]);\n\n  /**\n   * Shadow & Backdrop\n   */\n  const [shadowClass, setShadowClass] = useState('');\n  const [backdrop, setBackdrop] = useState('invisible');\n\n  useEffect(() => {\n    let timer: ReturnType<typeof setTimeout>;\n\n    if (props.show) {\n      timer = setTimeout(() => {\n        setShadowClass('drop-shadow-reversed');\n        setBackdrop('visible');\n      }, 0);\n    } else {\n      timer = setTimeout(() => {\n        setShadowClass('');\n        setBackdrop('invisible');\n      }, 800);\n    }\n\n    return () => {\n      clearTimeout(timer);\n    };\n  }, [props.show]);\n\n  return (\n    <div className={`${props.className} w-full h-full`}>\n      {props.backdrop && (\n        <div\n          className={`\n            ${backdrop}\n            ${props.show ? 'opacity-100' : 'opacity-0'}\n            w-full h-full bg-backdrop absolute left-0 top-0 transition-opacity duration-800`}\n        ></div>\n      )}\n      <div\n        ref={ref}\n        className={`\n          ${shadowClass} ${topClass} ${bottomClass}\n          w-full\n          pb-6 box-border rounded-t-3xl\n          first-letter:w-full bg-primary\n          fixed left-0 transition-top duration-800`}\n        style={{\n          top: props.show ? `calc(100% - ${height}px)` : `100%`,\n        }}\n      >\n        {props.header && (\n          <div onMouseDown={onMouseDown} aria-hidden='true'>\n            {props.handle && (\n              <div className='flex justify-center py-2'>\n                <div className='w-10 h-1 rounded bg-pressed'></div>\n              </div>\n            )}\n            <div\n              className={`\n                ${!props.handle && 'pt-3'} pb-3\n                flex justify-between border-b border-secondary`}\n            >\n              <div\n                className={`py-3.5 px-4 ${props.onPrefix ? 'cursor-pointer' : ''}`}\n                onClick={props.onPrefix}\n                aria-hidden='true'\n              >\n                <div className='w-5'>{props.prefix}</div>\n              </div>\n              <div className='flex justify-center items-center flex-col'>\n                <span className='text-body-bold-l'>{props.header}</span>\n                <span className='text-body-s text-tertiary'>{props.description}</span>\n              </div>\n              <div\n                className={`py-3.5 px-4 ${props.onSuffix ? 'cursor-pointer' : ''}`}\n                onClick={props.onSuffix}\n                aria-hidden='true'\n              >\n                <div className='w-5'>{props.suffix}</div>\n              </div>\n            </div>\n          </div>\n        )}\n        <div className={`px-4 ${props.header ? 'pt-4' : 'pt-9'}`}>{props.children}</div>\n      </div>\n    </div>\n  );\n};\n\nHCBottomSheet.defaultProps = {\n  show: false,\n  className: '',\n  header: '',\n  description: '',\n  backdrop: true,\n  handle: false,\n  keyboard: false,\n};\n\nexport default HCBottomSheet;\n"],"names":["HCBottomSheet","props","ref","useRef","height","setHeight","useState","dragging","setDragging","draggingPosY","setDraggingPosY","full","setFull","topClass","setTopClass","bottomClass","setBottomClass","onMouseDown","event","onMouseUp","useCallback","useEffect","_a","document","timer","clearTimeout","shadowClass","setShadowClass","backdrop","setBackdrop","_jsxs","className","_jsx","onPrefix","prefix","header","description","onSuffix","suffix","children","HCBottomSheet$1"],"mappings":"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"}